<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据类型与编码 | Clog</title>
    <meta name="description" content="

一个http报文必须是完整交付

大文件进行压缩时，是实时压缩实时传输，所以无法确定报文长度

在传输层将数据包拆封上交到应用层时，应用层开始设法解析数据的格式

&gt; 当然，它可以“猜”。因为很多数据都是有固定格式的，所以通过检查数据的前几个字节也许就能知道这是个 GIF 图片、或者是个 MP3 音乐文件，但这种方式无疑十分低效，而且有很大几率会检查不出来文件类型。

con ...">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/assets/css/0.styles.18c2a749.css" as="style"><link rel="preload" href="/assets/js/app.4b1e1b3d.js" as="script"><link rel="preload" href="/assets/js/6.90d8b0a4.js" as="script"><link rel="preload" href="/assets/js/13.d71f7fb4.js" as="script"><link rel="preload" href="/assets/js/85.daa5d9b4.js" as="script"><link rel="prefetch" href="/assets/js/1.d56f86e5.js"><link rel="prefetch" href="/assets/js/10.618b6d7a.js"><link rel="prefetch" href="/assets/js/11.59f5d7f5.js"><link rel="prefetch" href="/assets/js/12.e6eda927.js"><link rel="prefetch" href="/assets/js/14.29a562a6.js"><link rel="prefetch" href="/assets/js/15.4f4d6e84.js"><link rel="prefetch" href="/assets/js/16.5ab9252e.js"><link rel="prefetch" href="/assets/js/17.48db5f67.js"><link rel="prefetch" href="/assets/js/18.272c5b8f.js"><link rel="prefetch" href="/assets/js/19.c9e43428.js"><link rel="prefetch" href="/assets/js/20.e5f4711e.js"><link rel="prefetch" href="/assets/js/21.d2b26fab.js"><link rel="prefetch" href="/assets/js/22.ba442cb0.js"><link rel="prefetch" href="/assets/js/23.ba51e662.js"><link rel="prefetch" href="/assets/js/24.19d39f17.js"><link rel="prefetch" href="/assets/js/25.5142b57a.js"><link rel="prefetch" href="/assets/js/26.e6eb7937.js"><link rel="prefetch" href="/assets/js/27.ac6841a2.js"><link rel="prefetch" href="/assets/js/28.7c8307c8.js"><link rel="prefetch" href="/assets/js/29.8c95c4fa.js"><link rel="prefetch" href="/assets/js/30.635aaf7f.js"><link rel="prefetch" href="/assets/js/31.7b59d342.js"><link rel="prefetch" href="/assets/js/32.35ad53ae.js"><link rel="prefetch" href="/assets/js/33.6c299105.js"><link rel="prefetch" href="/assets/js/34.5f2e1be8.js"><link rel="prefetch" href="/assets/js/35.580b2561.js"><link rel="prefetch" href="/assets/js/36.7bb33ebe.js"><link rel="prefetch" href="/assets/js/37.52a5a396.js"><link rel="prefetch" href="/assets/js/38.0ebe221e.js"><link rel="prefetch" href="/assets/js/39.1015c0f8.js"><link rel="prefetch" href="/assets/js/4.da3f28c5.js"><link rel="prefetch" href="/assets/js/40.020bd197.js"><link rel="prefetch" href="/assets/js/41.65a65194.js"><link rel="prefetch" href="/assets/js/42.55cdbd80.js"><link rel="prefetch" href="/assets/js/43.8422be2c.js"><link rel="prefetch" href="/assets/js/44.33668108.js"><link rel="prefetch" href="/assets/js/45.b3ded315.js"><link rel="prefetch" href="/assets/js/46.eadeca92.js"><link rel="prefetch" href="/assets/js/47.60081668.js"><link rel="prefetch" href="/assets/js/48.8468270c.js"><link rel="prefetch" href="/assets/js/49.444245e4.js"><link rel="prefetch" href="/assets/js/5.373ed106.js"><link rel="prefetch" href="/assets/js/50.0bf638aa.js"><link rel="prefetch" href="/assets/js/51.601c1994.js"><link rel="prefetch" href="/assets/js/52.7432a82b.js"><link rel="prefetch" href="/assets/js/53.2cbb88f8.js"><link rel="prefetch" href="/assets/js/54.566e00a5.js"><link rel="prefetch" href="/assets/js/55.82bdae2c.js"><link rel="prefetch" href="/assets/js/56.352a9bcf.js"><link rel="prefetch" href="/assets/js/57.6b43514a.js"><link rel="prefetch" href="/assets/js/58.319eb472.js"><link rel="prefetch" href="/assets/js/59.5cbf1070.js"><link rel="prefetch" href="/assets/js/60.fe45dcb3.js"><link rel="prefetch" href="/assets/js/61.995eb879.js"><link rel="prefetch" href="/assets/js/62.4348c455.js"><link rel="prefetch" href="/assets/js/63.2db97682.js"><link rel="prefetch" href="/assets/js/64.c7e8215e.js"><link rel="prefetch" href="/assets/js/65.5933a627.js"><link rel="prefetch" href="/assets/js/66.1c91b950.js"><link rel="prefetch" href="/assets/js/67.56564cf6.js"><link rel="prefetch" href="/assets/js/68.8e27cc57.js"><link rel="prefetch" href="/assets/js/69.dc7a5b90.js"><link rel="prefetch" href="/assets/js/7.80766424.js"><link rel="prefetch" href="/assets/js/70.c9686c06.js"><link rel="prefetch" href="/assets/js/71.94965ca3.js"><link rel="prefetch" href="/assets/js/72.db932d40.js"><link rel="prefetch" href="/assets/js/73.219c2885.js"><link rel="prefetch" href="/assets/js/74.61dac4ea.js"><link rel="prefetch" href="/assets/js/75.9cd96759.js"><link rel="prefetch" href="/assets/js/76.033a832e.js"><link rel="prefetch" href="/assets/js/77.2b4c01f0.js"><link rel="prefetch" href="/assets/js/78.f706efe9.js"><link rel="prefetch" href="/assets/js/79.7452cf1e.js"><link rel="prefetch" href="/assets/js/8.389698f0.js"><link rel="prefetch" href="/assets/js/80.43bda541.js"><link rel="prefetch" href="/assets/js/81.cccd7099.js"><link rel="prefetch" href="/assets/js/82.127202ad.js"><link rel="prefetch" href="/assets/js/83.0d1a76a2.js"><link rel="prefetch" href="/assets/js/84.891f115c.js"><link rel="prefetch" href="/assets/js/86.9deeb1ca.js"><link rel="prefetch" href="/assets/js/87.42df0bbb.js"><link rel="prefetch" href="/assets/js/88.89edd320.js"><link rel="prefetch" href="/assets/js/89.478f49dc.js"><link rel="prefetch" href="/assets/js/9.92d7f2f1.js"><link rel="prefetch" href="/assets/js/90.2feb1628.js"><link rel="prefetch" href="/assets/js/91.37ccfe14.js"><link rel="prefetch" href="/assets/js/92.46cda28b.js"><link rel="prefetch" href="/assets/js/93.7d0867e8.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.7538008b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.18c2a749.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Clog </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/tech/" class="nav-link router-link-active">前端</a></li><li class="nav-item"><a href="/book/" class="nav-link">随笔</a></li><li class="nav-item"><a href="/algorithm/index.html" class="nav-link">算法</a></li><li class="nav-item"><a href="https://github.com/yuecai" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Clog </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/tech/" class="nav-link router-link-active">前端</a></li><li class="mobile-nav-item"><a href="/book/" class="nav-link">随笔</a></li><li class="mobile-nav-item"><a href="/algorithm/index.html" class="nav-link">算法</a></li><li class="mobile-nav-item"><a href="https://github.com/yuecai" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div><div class="content__default"><h3 id="数据类型与编码"><a href="#数据类型与编码" class="header-anchor">#</a> 数据类型与编码</h3> <ul><li><p>一个http报文必须是完整交付</p></li> <li><p>大文件进行压缩时，是实时压缩实时传输，所以无法确定报文长度</p></li></ul> <p>在传输层将数据包拆封上交到应用层时，应用层开始设法解析数据的格式</p> <blockquote><p>当然，它可以“猜”。因为很多数据都是有固定格式的，所以通过检查数据的前几个字节也许就能知道这是个 GIF 图片、或者是个 MP3 音乐文件，但这种方式无疑十分低效，而且有很大几率会检查不出来文件类型。</p></blockquote> <h4 id="content-type"><a href="#content-type" class="header-anchor">#</a> content-type</h4> <p>早在 HTTP 协议诞生之前就已经有了针对这种问题的解决方案，不过它是用在电子邮件系统里的，<strong>让电子邮件可以发送 ASCII 码以外的任意数据</strong>，方案的名字叫做“多用途互联网邮件扩展”<code>（Multipurpose Internet Mail Extensions）</code>，简称为 <code>MIME</code>。</p> <p>简单列举几种格式:</p> <ul><li><p><strong>text</strong>: text/html 了，表示超文本文档，此外还有纯文本 text/plain、样式表 text/css 等</p></li> <li><p><strong>image</strong></p></li> <li><p><strong>audio/video</strong></p></li> <li><p><strong>application</strong>：数据格式不固定，可能是文本也可能是二进制，必须由上层应用程序来解释。常见的有 <code>application/json</code>，<code>application/javascript</code>、<code>application/pdf</code> 等，另外，如果实在是不知道数据是什么类型，像刚才说的“黑盒”，就会是 <code>application/octet-stream</code>，即不透明的二进制数据。</p></li></ul> <h4 id="encoding-type"><a href="#encoding-type" class="header-anchor">#</a> encoding type</h4> <p>但仅有 MIME type 还不够，因为 HTTP 在传输时为了节约带宽，有时候还会压缩数据，为了不要让浏览器继续“猜”，还需要有一个“Encoding type”，告诉数据是用的什么编码格式，这样对方才能正确解压缩，还原出原始的数据。</p> <h4 id="客户端和服务端的内容协商"><a href="#客户端和服务端的内容协商" class="header-anchor">#</a> 客户端和服务端的内容协商</h4> <p>有了 MIME type 和 Encoding type，无论是浏览器还是服务器就都可以轻松识别出 body 的类型，也就能够正确处理数据了。</p> <p>HTTP 协议为此定义了两个 Accept 请求头字段和两个 Content 实体头字段，用于客户端和服务器进行“内容协商”。也就是说，客户端用 Accept 头告诉服务器希望接收什么样的数据，而服务器用 Content 头告诉客户端实际发送了什么样的数据。</p> <p>Accept-Encoding字段标记的是客户端支持的压缩格式，例如上面说的 gzip、deflate 等，同样也可以用“,”列出多个，服务器可以选择其中一种来压缩数据，实际使用的压缩格式放在响应头字段Content-Encoding里。</p> <blockquote><p>不过这两个字段是可以省略的，如果请求报文里没有 Accept-Encoding 字段，就表示客户端不支持压缩数据；如果响应报文里没有 Content-Encoding 字段，就表示响应数据没有被压缩。</p></blockquote></div></div></div> <footer class="footer" data-v-582f9766><div class="footer-left-wrap" data-v-582f9766><ul class="contact" data-v-582f9766></ul></div> <div class="footer-right-wrap" data-v-582f9766><ul class="copyright" data-v-582f9766></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4b1e1b3d.js" defer></script><script src="/assets/js/6.90d8b0a4.js" defer></script><script src="/assets/js/13.d71f7fb4.js" defer></script><script src="/assets/js/85.daa5d9b4.js" defer></script>
  </body>
</html>
